# ğŸ® ç©å®¶å¥åº·ç³»ç»Ÿè¯¦ç»†ä½¿ç”¨æ•™ç¨‹

## ğŸ“– ç›®å½•
1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
3. [è¯¦ç»†å®‰è£…æ­¥éª¤](#è¯¦ç»†å®‰è£…æ­¥éª¤)
4. [UIç•Œé¢è®¾ç½®](#uiç•Œé¢è®¾ç½®)
5. [è„šæœ¬è°ƒç”¨æ–¹æ³•](#è„šæœ¬è°ƒç”¨æ–¹æ³•)
6. [æµ‹è¯•å’Œè°ƒè¯•](#æµ‹è¯•å’Œè°ƒè¯•)
7. [è‡ªå®šä¹‰é…ç½®](#è‡ªå®šä¹‰é…ç½®)
8. [é«˜çº§åŠŸèƒ½](#é«˜çº§åŠŸèƒ½)
9. [å¸¸è§é—®é¢˜è§£å†³](#å¸¸è§é—®é¢˜è§£å†³)
10. [å®Œæ•´ä»£ç ç¤ºä¾‹](#å®Œæ•´ä»£ç ç¤ºä¾‹)

---

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

è¿™ä¸ªç©å®¶å¥åº·ç³»ç»ŸåŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š

### ğŸ—ï¸ æ ¸å¿ƒè„šæœ¬
- **PlayerHealthSystem.cs** - å¥åº·ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘
- **HealthBarUI.cs** - UIæ˜¾ç¤ºå’ŒåŠ¨ç”»
- **HealthSystemExample.cs** - ä½¿ç”¨ç¤ºä¾‹å’Œæµ‹è¯•
- **HealthSystemSetup.cs** - å¿«é€Ÿè®¾ç½®åŠ©æ‰‹

### âš¡ ä¸»è¦åŠŸèƒ½
- âœ… è¡€é‡ç®¡ç†ï¼ˆå¢åŠ /å‡å°‘/è®¾ç½®ä¸Šé™ï¼‰
- âœ… æŠ€èƒ½å€¼ç®¡ç†ï¼ˆæ¶ˆè€—/æ¢å¤/è‡ªåŠ¨å›å¤ï¼‰
- âœ… äº‹ä»¶é©±åŠ¨UIæ›´æ–°
- âœ… å¹³æ»‘åŠ¨ç”»æ•ˆæœ
- âœ… æ™ºèƒ½é¢œè‰²å˜åŒ–
- âœ… å®Œæ•´çš„APIæ¥å£

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šè‡ªåŠ¨è®¾ç½®ï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. **æ·»åŠ è®¾ç½®è„šæœ¬**
   ```
   åœ¨Unityä¸­ï¼Œå°† HealthSystemSetup.cs æ‹–æ‹½åˆ°åœºæ™¯ä¸­ä»»æ„GameObjectä¸Š
   ```

2. **è¿è¡Œæ¸¸æˆ**
   ```
   ç‚¹å‡»Playï¼Œè„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰è®¾ç½®
   ```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨è®¾ç½®ï¼ˆæ¨èæœ‰ç»éªŒç”¨æˆ·ï¼‰

1. **æ·»åŠ æ ¸å¿ƒç³»ç»Ÿ**
   ```
   å°† PlayerHealthSystem.cs æ·»åŠ åˆ°æ‚¨çš„ç©å®¶GameObjectä¸Š
   ```

2. **è®¾ç½®UI**
   ```
   æŒ‰ç…§ä¸‹é¢çš„è¯¦ç»†æ­¥éª¤åˆ›å»ºUIç•Œé¢
   ```

---

## ğŸ”§ è¯¦ç»†å®‰è£…æ­¥éª¤

### æ­¥éª¤1ï¼šå‡†å¤‡ç©å®¶å¯¹è±¡

1. **ç¡®è®¤PlayerControllerå­˜åœ¨**
   ```
   æ£€æŸ¥åœºæ™¯ä¸­æ˜¯å¦æœ‰PlayerControllerè„šæœ¬çš„GameObject
   å¦‚æœæ²¡æœ‰ï¼Œè¯·å…ˆè®¾ç½®å¥½åŸºæœ¬çš„ç©å®¶æ§åˆ¶å™¨
   ```

2. **æ·»åŠ å¥åº·ç³»ç»Ÿ**
   ```csharp
   // åœ¨PlayerControllerå¯¹è±¡ä¸Šæ·»åŠ  PlayerHealthSystem ç»„ä»¶
   // æˆ–è€…åœ¨ä»£ç ä¸­åŠ¨æ€æ·»åŠ ï¼š
   gameObject.AddComponent<PlayerHealthSystem>();
   ```

### æ­¥éª¤2ï¼šé…ç½®å¥åº·ç³»ç»Ÿå‚æ•°

åœ¨ **PlayerHealthSystem** ç»„ä»¶çš„Inspectoré¢æ¿ä¸­è®¾ç½®ï¼š

```
å¥åº·è®¾ç½®:
â”œâ”€â”€ Max Health: 100          (æœ€å¤§è¡€é‡)
â”œâ”€â”€ Current Health: 100      (å½“å‰è¡€é‡ï¼Œè¿è¡Œæ—¶è‡ªåŠ¨è®¾ç½®)

æŠ€èƒ½è®¾ç½®:
â”œâ”€â”€ Max Skill Points: 100    (æœ€å¤§æŠ€èƒ½å€¼)
â”œâ”€â”€ Current Skill Points: 100 (å½“å‰æŠ€èƒ½å€¼ï¼Œè¿è¡Œæ—¶è‡ªåŠ¨è®¾ç½®)

æŠ€èƒ½å€¼æ¢å¤è®¾ç½®:
â”œâ”€â”€ Skill Regen Rate: 5      (æ¯ç§’æ¢å¤çš„æŠ€èƒ½å€¼)
â””â”€â”€ Auto Regen Skill: âœ“      (æ˜¯å¦è‡ªåŠ¨æ¢å¤æŠ€èƒ½å€¼)
```

### æ­¥éª¤3ï¼šåˆ›å»ºUIç•Œé¢

#### 3.1 åˆ›å»ºCanvasï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
```
1. å³é”®Hierarchy â†’ UI â†’ Canvas
2. ç¡®ä¿Canvas Scalerè®¾ç½®ä¸ºScale With Screen Size
```

#### 3.2 åˆ›å»ºè¡€é‡æ¡UIç»“æ„
```
Canvas
â””â”€â”€ HealthUI (ç©ºGameObject)
    â”œâ”€â”€ HealthBar (Sliderç»„ä»¶)
    â”‚   â”œâ”€â”€ Background (Imageç»„ä»¶)
    â”‚   â”œâ”€â”€ Fill Area (RectTransform)
    â”‚   â”‚   â””â”€â”€ Fill (Imageç»„ä»¶ - çº¢è‰²)
    â”‚   â””â”€â”€ Background Fill (Imageç»„ä»¶ - åŠé€æ˜ç™½è‰²)
    â”œâ”€â”€ HealthText (TextMeshProç»„ä»¶)
    â”œâ”€â”€ SkillBar (Sliderç»„ä»¶)
    â”‚   â”œâ”€â”€ Background (Imageç»„ä»¶)
    â”‚   â”œâ”€â”€ Fill Area (RectTransform)
    â”‚   â”‚   â””â”€â”€ Fill (Imageç»„ä»¶ - è“è‰²)
    â””â”€â”€ SkillText (TextMeshProç»„ä»¶)
```

#### 3.3 è¯¦ç»†UIåˆ›å»ºæ­¥éª¤

**åˆ›å»ºè¡€é‡æ¡ï¼š**
```
1. å³é”®HealthUI â†’ UI â†’ Slider
2. é‡å‘½åä¸º"HealthBar"
3. è®¾ç½®Sliderå±æ€§ï¼š
   - Min Value: 0
   - Max Value: 1
   - Value: 1
4. è°ƒæ•´å¤§å°å’Œä½ç½®
5. è®¾ç½®Fillçš„é¢œè‰²ä¸ºçº¢è‰² (#FF0000)
```

**åˆ›å»ºæŠ€èƒ½æ¡ï¼š**
```
1. å¤åˆ¶HealthBar
2. é‡å‘½åä¸º"SkillBar"
3. è®¾ç½®Fillçš„é¢œè‰²ä¸ºè“è‰² (#0080FF)
4. æ”¾ç½®åœ¨è¡€é‡æ¡ä¸‹æ–¹
```

**æ·»åŠ æ–‡å­—æ˜¾ç¤ºï¼š**
```
1. å³é”®HealthUI â†’ UI â†’ Text - TextMeshPro
2. é‡å‘½åä¸º"HealthText"
3. è®¾ç½®æ–‡å­—å†…å®¹ä¸º"100/100"
4. è°ƒæ•´å­—ä½“å¤§å°å’Œé¢œè‰²
5. å¤åˆ¶ä¸€ä»½ä½œä¸º"SkillText"
```

### æ­¥éª¤4ï¼šè¿æ¥UIç»„ä»¶

1. **æ·»åŠ HealthBarUIè„šæœ¬**
   ```
   å°† HealthBarUI.cs è„šæœ¬æ·»åŠ åˆ° HealthUI GameObjectä¸Š
   ```

2. **è¿æ¥UIå¼•ç”¨**
   åœ¨HealthBarUIç»„ä»¶çš„Inspectorä¸­ï¼š
   ```
   è¡€é‡UIå¼•ç”¨:
   â”œâ”€â”€ Health Slider: æ‹–æ‹½HealthBar
   â”œâ”€â”€ Health Fill: æ‹–æ‹½HealthBarçš„Fill
   â”œâ”€â”€ Health Text: æ‹–æ‹½HealthText
   â””â”€â”€ Health Background Fill: æ‹–æ‹½Background Fill

   æŠ€èƒ½å€¼UIå¼•ç”¨:
   â”œâ”€â”€ Skill Slider: æ‹–æ‹½SkillBar
   â”œâ”€â”€ Skill Fill: æ‹–æ‹½SkillBarçš„Fill
   â””â”€â”€ Skill Text: æ‹–æ‹½SkillText
   ```

3. **é…ç½®UIè®¾ç½®**
   ```
   é¢œè‰²è®¾ç½®:
   â”œâ”€â”€ Health Color: çº¢è‰² #FF0000
   â”œâ”€â”€ Skill Color: è“è‰² #0080FF
   â”œâ”€â”€ Low Health Color: é»„è‰² #FFFF00
   â””â”€â”€ Critical Health Color: æ·±çº¢è‰² #800000

   åŠ¨ç”»è®¾ç½®:
   â”œâ”€â”€ Smooth Speed: 2
   â”œâ”€â”€ Background Fade Speed: 1
   â””â”€â”€ Smooth Transition: âœ“

   é˜ˆå€¼è®¾ç½®:
   â”œâ”€â”€ Low Health Threshold: 0.3 (30%)
   â””â”€â”€ Critical Health Threshold: 0.15 (15%)
   ```

---

## ğŸ’» è„šæœ¬è°ƒç”¨æ–¹æ³•

### åŸºç¡€è°ƒç”¨ç¤ºä¾‹

#### é€ æˆä¼¤å®³
```csharp
// ç®€å•é€ æˆä¼¤å®³
PlayerHealthSystem.instance.TakeDamage(25f);

// è·å–å®é™…é€ æˆçš„ä¼¤å®³
float actualDamage = PlayerHealthSystem.instance.TakeDamage(25f);
Debug.Log($"å®é™…é€ æˆä¼¤å®³: {actualDamage}");
```

#### æ²»ç–—è¡€é‡
```csharp
// ç®€å•æ²»ç–—
PlayerHealthSystem.instance.AddHealth(30f);

// è·å–å®é™…æ²»ç–—é‡
float actualHeal = PlayerHealthSystem.instance.AddHealth(30f);
Debug.Log($"å®é™…æ²»ç–—é‡: {actualHeal}");

// æ²»ç–—åˆ°æ»¡è¡€
PlayerHealthSystem.instance.FullHeal();
```

#### æŠ€èƒ½å€¼ç®¡ç†
```csharp
// æ£€æŸ¥æŠ€èƒ½å€¼æ˜¯å¦è¶³å¤Ÿ
if (PlayerHealthSystem.instance.HasEnoughSkillPoints(50f))
{
    // æ¶ˆè€—æŠ€èƒ½å€¼
    if (PlayerHealthSystem.instance.ConsumeSkillPoints(50f))
    {
        Debug.Log("æŠ€èƒ½é‡Šæ”¾æˆåŠŸï¼");
        // æ‰§è¡ŒæŠ€èƒ½æ•ˆæœ
    }
}

// æ¢å¤æŠ€èƒ½å€¼
PlayerHealthSystem.instance.AddSkillPoints(25f);

// æŠ€èƒ½å€¼å›æ»¡
PlayerHealthSystem.instance.RestoreFullSkill();
```

### å®é™…æ¸¸æˆåœºæ™¯åº”ç”¨

#### æ•ŒäººAIæ”»å‡»è„šæœ¬
```csharp
public class EnemyAttack : MonoBehaviour
{
    [SerializeField] private float attackDamage = 20f;
    
    private void AttackPlayer()
    {
        // é€ æˆä¼¤å®³
        float damage = PlayerHealthSystem.instance.TakeDamage(attackDamage);
        
        // æ˜¾ç¤ºä¼¤å®³æ•°å­—æˆ–æ•ˆæœ
        if (damage > 0)
        {
            Debug.Log($"æ•Œäººæ”»å‡»é€ æˆ {damage} ç‚¹ä¼¤å®³ï¼");
            // è¿™é‡Œå¯ä»¥æ·»åŠ ä¼¤å®³ç‰¹æ•ˆã€éŸ³æ•ˆç­‰
        }
    }
}
```

#### ç‰©å“ä½¿ç”¨è„šæœ¬
```csharp
public class HealthPotion : MonoBehaviour
{
    [SerializeField] private float healAmount = 50f;
    
    public void UsePotion()
    {
        float actualHeal = PlayerHealthSystem.instance.AddHealth(healAmount);
        
        if (actualHeal > 0)
        {
            Debug.Log($"ä½¿ç”¨æ²»ç–—è¯æ°´ï¼Œæ¢å¤ {actualHeal} ç‚¹è¡€é‡");
            
            // æ˜¾ç¤ºæ²»ç–—æ•ˆæœ
            if (UIManager.instance != null)
            {
                UIManager.instance.ShowNotification($"è¡€é‡ +{actualHeal}", 2f);
            }
            
            // é”€æ¯ç‰©å“
            Destroy(gameObject);
        }
    }
}
```

#### æŠ€èƒ½é‡Šæ”¾è„šæœ¬
```csharp
public class PlayerSkills : MonoBehaviour
{
    [Header("æŠ€èƒ½è®¾ç½®")]
    [SerializeField] private float fireballCost = 30f;
    [SerializeField] private float healCost = 40f;
    [SerializeField] private float shieldCost = 50f;
    
    private void Update()
    {
        if (Input.GetKeyDown(KeyCode.Q))
        {
            CastFireball();
        }
        
        if (Input.GetKeyDown(KeyCode.E))
        {
            CastHeal();
        }
        
        if (Input.GetKeyDown(KeyCode.R))
        {
            CastShield();
        }
    }
    
    private void CastFireball()
    {
        if (PlayerHealthSystem.instance.ConsumeSkillPoints(fireballCost))
        {
            Debug.Log("ç«çƒæœ¯é‡Šæ”¾ï¼");
            // æ·»åŠ ç«çƒæ•ˆæœ
        }
        else
        {
            Debug.Log("æŠ€èƒ½å€¼ä¸è¶³ï¼");
        }
    }
    
    private void CastHeal()
    {
        if (PlayerHealthSystem.instance.ConsumeSkillPoints(healCost))
        {
            // æ²»ç–—æ•ˆæœ
            PlayerHealthSystem.instance.AddHealth(60f);
            Debug.Log("æ²»ç–—æœ¯é‡Šæ”¾ï¼");
        }
        else
        {
            Debug.Log("æŠ€èƒ½å€¼ä¸è¶³ï¼");
        }
    }
    
    private void CastShield()
    {
        if (PlayerHealthSystem.instance.ConsumeSkillPoints(shieldCost))
        {
            Debug.Log("æŠ¤ç›¾æ¿€æ´»ï¼");
            // æ·»åŠ æŠ¤ç›¾æ•ˆæœ
            StartCoroutine(ShieldEffect());
        }
        else
        {
            Debug.Log("æŠ€èƒ½å€¼ä¸è¶³ï¼");
        }
    }
    
    private IEnumerator ShieldEffect()
    {
        // 5ç§’æŠ¤ç›¾æ•ˆæœ
        Debug.Log("æŠ¤ç›¾ç”Ÿæ•ˆä¸­...");
        yield return new WaitForSeconds(5f);
        Debug.Log("æŠ¤ç›¾æ•ˆæœç»“æŸ");
    }
}
```

### äº‹ä»¶è®¢é˜…ç¤ºä¾‹

```csharp
public class GameEventListener : MonoBehaviour
{
    private void Start()
    {
        // è®¢é˜…å¥åº·ç³»ç»Ÿäº‹ä»¶
        if (PlayerHealthSystem.instance != null)
        {
            PlayerHealthSystem.instance.OnHealthChanged += OnHealthChanged;
            PlayerHealthSystem.instance.OnSkillChanged += OnSkillChanged;
            PlayerHealthSystem.instance.OnPlayerDeath += OnPlayerDeath;
        }
    }
    
    private void OnDestroy()
    {
        // å–æ¶ˆè®¢é˜…
        if (PlayerHealthSystem.instance != null)
        {
            PlayerHealthSystem.instance.OnHealthChanged -= OnHealthChanged;
            PlayerHealthSystem.instance.OnSkillChanged -= OnSkillChanged;
            PlayerHealthSystem.instance.OnPlayerDeath -= OnPlayerDeath;
        }
    }
    
    private void OnHealthChanged(float current, float max)
    {
        float percentage = current / max;
        
        if (percentage <= 0.2f)
        {
            // è¡€é‡å±é™©ï¼Œæ’­æ”¾å¿ƒè·³éŸ³æ•ˆ
            PlayHeartbeatSound();
        }
    }
    
    private void OnSkillChanged(float current, float max)
    {
        float percentage = current / max;
        
        if (percentage >= 1f)
        {
            // æŠ€èƒ½å€¼æ»¡äº†ï¼Œæ’­æ”¾å……èƒ½å®ŒæˆéŸ³æ•ˆ
            PlayManaFullSound();
        }
    }
    
    private void OnPlayerDeath()
    {
        Debug.Log("ç©å®¶æ­»äº¡ï¼");
        
        // åœæ­¢æ¸¸æˆæˆ–æ˜¾ç¤ºæ­»äº¡ç•Œé¢
        Time.timeScale = 0f;
        
        // æ˜¾ç¤ºé‡ç”Ÿç•Œé¢
        // ShowRespawnUI();
    }
    
    private void PlayHeartbeatSound()
    {
        // æ’­æ”¾å¿ƒè·³éŸ³æ•ˆ
    }
    
    private void PlayManaFullSound()
    {
        // æ’­æ”¾æŠ€èƒ½å€¼æ»¡çš„éŸ³æ•ˆ
    }
}
```

---

## ğŸ§ª æµ‹è¯•å’Œè°ƒè¯•

### ä½¿ç”¨æµ‹è¯•è„šæœ¬

1. **æ·»åŠ æµ‹è¯•ç»„ä»¶**
   ```
   å°† HealthSystemExample.cs æ·»åŠ åˆ°ç©å®¶å¯¹è±¡ä¸Š
   ```

2. **æµ‹è¯•æŒ‰é”®**
   ```
   H - é€ æˆä¼¤å®³ (10ç‚¹)
   J - æ²»ç–— (15ç‚¹)
   K - æ¶ˆè€—æŠ€èƒ½å€¼ (20ç‚¹)
   L - æ¢å¤æŠ€èƒ½å€¼ (25ç‚¹)
   R - é‡ç½®åˆ°æ»¡å€¼
   
   1 - ç«çƒæœ¯ (æ¶ˆè€—30ç‚¹æŠ€èƒ½å€¼)
   2 - æ²»ç–—æœ¯ (æ¶ˆè€—40ç‚¹æŠ€èƒ½å€¼ï¼Œæ¢å¤50ç‚¹è¡€é‡)
   3 - æŠ¤ç›¾ (æ¶ˆè€—50ç‚¹æŠ€èƒ½å€¼)
   ```

3. **æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯**
   ```csharp
   // åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨ï¼Œè·å–å½“å‰çŠ¶æ€
   Debug.Log(PlayerHealthSystem.instance.GetStatusInfo());
   
   // è¾“å‡ºç¤ºä¾‹ï¼š
   // è¡€é‡: 75.0/100.0 (75%)
   // æŠ€èƒ½: 60.0/100.0 (60%)
   // çŠ¶æ€: å­˜æ´»
   ```

### Inspectorè°ƒè¯•

åœ¨æ¸¸æˆè¿è¡Œæ—¶ï¼Œæ‚¨å¯ä»¥åœ¨Inspectorä¸­å®æ—¶çœ‹åˆ°ï¼š
- å½“å‰è¡€é‡å’Œæœ€å¤§è¡€é‡
- å½“å‰æŠ€èƒ½å€¼å’Œæœ€å¤§æŠ€èƒ½å€¼
- æŠ€èƒ½æ¢å¤é€Ÿåº¦
- æ˜¯å¦è‡ªåŠ¨æ¢å¤æŠ€èƒ½å€¼

### å¸¸ç”¨è°ƒè¯•ä»£ç 

```csharp
// æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œ
if (PlayerHealthSystem.instance == null)
{
    Debug.LogError("PlayerHealthSystemæœªæ‰¾åˆ°ï¼");
}

// æ£€æŸ¥å½“å‰çŠ¶æ€
var health = PlayerHealthSystem.instance;
Debug.Log($"è¡€é‡ç™¾åˆ†æ¯”: {health.HealthPercentage:P}");
Debug.Log($"æŠ€èƒ½ç™¾åˆ†æ¯”: {health.SkillPercentage:P}");
Debug.Log($"æ˜¯å¦æ­»äº¡: {health.IsDead}");

// å¼ºåˆ¶è§¦å‘äº‹ä»¶æµ‹è¯•
health.OnHealthChanged?.Invoke(health.CurrentHealth, health.MaxHealth);
```

---

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹é»˜è®¤æ•°å€¼

åœ¨ **PlayerHealthSystem** è„šæœ¬ä¸­ï¼š
```csharp
[Header("å¥åº·è®¾ç½®")]
[SerializeField] private float maxHealth = 150f;        // æ”¹ä¸º150è¡€é‡
[SerializeField] private float currentHealth;

[Header("æŠ€èƒ½è®¾ç½®")]
[SerializeField] private float maxSkillPoints = 200f;   // æ”¹ä¸º200æŠ€èƒ½å€¼
[SerializeField] private float currentSkillPoints;

[Header("æŠ€èƒ½å€¼æ¢å¤è®¾ç½®")]
[SerializeField] private float skillRegenRate = 10f;    // æ”¹ä¸ºæ¯ç§’æ¢å¤10ç‚¹
```

### è‡ªå®šä¹‰UIé¢œè‰²å’Œæ•ˆæœ

åœ¨ **HealthBarUI** è„šæœ¬ä¸­ï¼š
```csharp
[Header("é¢œè‰²è®¾ç½®")]
[SerializeField] private Color healthColor = Color.green;     // æ”¹ä¸ºç»¿è‰²è¡€é‡æ¡
[SerializeField] private Color skillColor = Color.yellow;     // æ”¹ä¸ºé»„è‰²æŠ€èƒ½æ¡
[SerializeField] private Color lowHealthColor = Color.orange; // æ”¹ä¸ºæ©™è‰²ä½è¡€é‡
[SerializeField] private Color criticalHealthColor = Color.red;

[Header("åŠ¨ç”»è®¾ç½®")]
[SerializeField] private float smoothSpeed = 5f;             // æ›´å¿«çš„åŠ¨ç”»
[SerializeField] private float backgroundFadeSpeed = 2f;     // æ›´å¿«çš„èƒŒæ™¯æ¶ˆå¤±

[Header("é˜ˆå€¼è®¾ç½®")]
[SerializeField] private float lowHealthThreshold = 0.5f;    // 50%ä»¥ä¸‹æ˜¾ç¤ºä½è¡€é‡é¢œè‰²
[SerializeField] private float criticalHealthThreshold = 0.2f; // 20%ä»¥ä¸‹æ˜¾ç¤ºå±é™©é¢œè‰²
```

### æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½

#### æŠ¤ç”²ç³»ç»Ÿ
```csharp
public class ArmorSystem : MonoBehaviour
{
    [SerializeField] private float armorValue = 10f;
    
    private void Start()
    {
        // è®¢é˜…ä¼¤å®³äº‹ä»¶ï¼Œåœ¨ä¼¤å®³åº”ç”¨å‰è¿›è¡ŒæŠ¤ç”²è®¡ç®—
        PlayerHealthSystem.instance.OnHealthChanged += OnDamageTaken;
    }
    
    private void OnDamageTaken(float current, float max)
    {
        // æŠ¤ç”²å‡ä¼¤é€»è¾‘
    }
    
    // ä¿®æ”¹PlayerHealthSystemçš„TakeDamageæ–¹æ³•ä»¥æ”¯æŒæŠ¤ç”²
    public float CalculateArmorDamage(float damage)
    {
        return Mathf.Max(1f, damage - armorValue); // æœ€å°‘é€ æˆ1ç‚¹ä¼¤å®³
    }
}
```

#### ç»éªŒå’Œå‡çº§ç³»ç»Ÿ
```csharp
public class LevelSystem : MonoBehaviour
{
    [SerializeField] private int currentLevel = 1;
    [SerializeField] private float currentExp = 0f;
    [SerializeField] private float expToNextLevel = 100f;
    
    public void AddExperience(float exp)
    {
        currentExp += exp;
        
        if (currentExp >= expToNextLevel)
        {
            LevelUp();
        }
    }
    
    private void LevelUp()
    {
        currentLevel++;
        currentExp -= expToNextLevel;
        expToNextLevel *= 1.2f; // æ¯çº§éœ€è¦çš„ç»éªŒå¢åŠ 20%
        
        // å‡çº§æ—¶å¢åŠ è¡€é‡å’ŒæŠ€èƒ½å€¼ä¸Šé™
        float healthIncrease = 20f;
        float skillIncrease = 15f;
        
        var health = PlayerHealthSystem.instance;
        health.SetMaxHealth(health.MaxHealth + healthIncrease, true);
        health.SetMaxSkillPoints(health.MaxSkillPoints + skillIncrease, true);
        
        Debug.Log($"å‡çº§åˆ° {currentLevel} çº§ï¼è¡€é‡ä¸Šé™ +{healthIncrease}ï¼ŒæŠ€èƒ½å€¼ä¸Šé™ +{skillIncrease}");
    }
}
```

---

## ğŸ”® é«˜çº§åŠŸèƒ½

### çŠ¶æ€æ•ˆæœç³»ç»Ÿ

```csharp
public class StatusEffectSystem : MonoBehaviour
{
    [System.Serializable]
    public class StatusEffect
    {
        public string name;
        public float duration;
        public float healthPerSecond;  // æ¯ç§’è¡€é‡å˜åŒ–ï¼ˆæ­£æ•°å›è¡€ï¼Œè´Ÿæ•°æ‰è¡€ï¼‰
        public float skillPerSecond;   // æ¯ç§’æŠ€èƒ½å€¼å˜åŒ–
    }
    
    private List<StatusEffect> activeEffects = new List<StatusEffect>();
    
    public void ApplyStatusEffect(StatusEffect effect)
    {
        activeEffects.Add(effect);
        StartCoroutine(ProcessStatusEffect(effect));
    }
    
    private IEnumerator ProcessStatusEffect(StatusEffect effect)
    {
        float timer = 0f;
        
        while (timer < effect.duration)
        {
            // åº”ç”¨æ¯ç§’æ•ˆæœ
            if (effect.healthPerSecond != 0)
            {
                if (effect.healthPerSecond > 0)
                {
                    PlayerHealthSystem.instance.AddHealth(effect.healthPerSecond * Time.deltaTime);
                }
                else
                {
                    PlayerHealthSystem.instance.TakeDamage(-effect.healthPerSecond * Time.deltaTime);
                }
            }
            
            if (effect.skillPerSecond != 0)
            {
                PlayerHealthSystem.instance.AddSkillPoints(effect.skillPerSecond * Time.deltaTime);
            }
            
            timer += Time.deltaTime;
            yield return null;
        }
        
        activeEffects.Remove(effect);
        Debug.Log($"çŠ¶æ€æ•ˆæœ {effect.name} ç»“æŸ");
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public void ApplyPoisonEffect()
    {
        StatusEffect poison = new StatusEffect
        {
            name = "ä¸­æ¯’",
            duration = 10f,
            healthPerSecond = -5f,  // æ¯ç§’æ‰5è¡€
            skillPerSecond = 0f
        };
        ApplyStatusEffect(poison);
    }
    
    public void ApplyRegenerationEffect()
    {
        StatusEffect regen = new StatusEffect
        {
            name = "æ¢å¤",
            duration = 15f,
            healthPerSecond = 3f,   // æ¯ç§’å›3è¡€
            skillPerSecond = 2f     // æ¯ç§’å›2æŠ€èƒ½å€¼
        };
        ApplyStatusEffect(regen);
    }
}
```

### ä¿å­˜å’Œè¯»å–ç³»ç»Ÿ

```csharp
[System.Serializable]
public class HealthSystemSaveData
{
    public float currentHealth;
    public float maxHealth;
    public float currentSkillPoints;
    public float maxSkillPoints;
    public float skillRegenRate;
    public bool autoRegenSkill;
}

public static class HealthSystemSaveManager
{
    private const string SAVE_KEY = "HealthSystemData";
    
    public static void SaveHealthSystem()
    {
        var health = PlayerHealthSystem.instance;
        if (health == null) return;
        
        HealthSystemSaveData data = new HealthSystemSaveData
        {
            currentHealth = health.CurrentHealth,
            maxHealth = health.MaxHealth,
            currentSkillPoints = health.CurrentSkillPoints,
            maxSkillPoints = health.MaxSkillPoints,
            // ä¿å­˜å…¶ä»–éœ€è¦çš„æ•°æ®
        };
        
        string json = JsonUtility.ToJson(data);
        PlayerPrefs.SetString(SAVE_KEY, json);
        PlayerPrefs.Save();
        
        Debug.Log("å¥åº·ç³»ç»Ÿæ•°æ®å·²ä¿å­˜");
    }
    
    public static void LoadHealthSystem()
    {
        if (!PlayerPrefs.HasKey(SAVE_KEY)) return;
        
        string json = PlayerPrefs.GetString(SAVE_KEY);
        HealthSystemSaveData data = JsonUtility.FromJson<HealthSystemSaveData>(json);
        
        var health = PlayerHealthSystem.instance;
        if (health == null) return;
        
        // æ¢å¤æ•°æ®
        health.SetMaxHealth(data.maxHealth, false);
        health.SetMaxSkillPoints(data.maxSkillPoints, false);
        // è®¾ç½®å½“å‰å€¼éœ€è¦é€šè¿‡åå°„æˆ–æ·»åŠ æ–°çš„æ–¹æ³•
        
        Debug.Log("å¥åº·ç³»ç»Ÿæ•°æ®å·²åŠ è½½");
    }
}

// åœ¨é€‚å½“çš„åœ°æ–¹è°ƒç”¨
public class GameManager : MonoBehaviour
{
    private void Start()
    {
        HealthSystemSaveManager.LoadHealthSystem();
    }
    
    private void OnApplicationPause(bool pauseStatus)
    {
        if (pauseStatus)
        {
            HealthSystemSaveManager.SaveHealthSystem();
        }
    }
    
    private void OnApplicationFocus(bool hasFocus)
    {
        if (!hasFocus)
        {
            HealthSystemSaveManager.SaveHealthSystem();
        }
    }
}
```

---

## â— å¸¸è§é—®é¢˜è§£å†³

### Q1: UIä¸æ˜¾ç¤ºæˆ–ä¸æ›´æ–°
**åŸå› ï¼š** UIç»„ä»¶è¿æ¥ä¸æ­£ç¡®æˆ–PlayerHealthSystemä¸å­˜åœ¨

**è§£å†³æ–¹æ¡ˆï¼š**
```csharp
// æ£€æŸ¥PlayerHealthSystemæ˜¯å¦å­˜åœ¨
if (PlayerHealthSystem.instance == null)
{
    Debug.LogError("PlayerHealthSystemå®ä¾‹æœªæ‰¾åˆ°ï¼è¯·ç¡®ä¿è„šæœ¬å·²æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚");
}

// æ£€æŸ¥UIç»„ä»¶æ˜¯å¦è¿æ¥
if (healthSlider == null)
{
    Debug.LogError("è¡€é‡æ»‘åŠ¨æ¡æœªè¿æ¥ï¼è¯·åœ¨Inspectorä¸­è®¾ç½®Health Sliderå­—æ®µã€‚");
}
```

### Q2: äº‹ä»¶ä¸è§¦å‘
**åŸå› ï¼š** äº‹ä»¶è®¢é˜…æ—¶æœºä¸å¯¹æˆ–å¯¹è±¡å·²é”€æ¯

**è§£å†³æ–¹æ¡ˆï¼š**
```csharp
private void Start()
{
    // å»¶è¿Ÿä¸€å¸§ç¡®ä¿PlayerHealthSystemå·²åˆå§‹åŒ–
    StartCoroutine(SubscribeToHealthEvents());
}

private IEnumerator SubscribeToHealthEvents()
{
    yield return null; // ç­‰å¾…ä¸€å¸§
    
    if (PlayerHealthSystem.instance != null)
    {
        PlayerHealthSystem.instance.OnHealthChanged += UpdateHealthDisplay;
    }
    else
    {
        Debug.LogWarning("PlayerHealthSystemä»æœªæ‰¾åˆ°ï¼Œç¨åé‡è¯•...");
        yield return new WaitForSeconds(0.1f);
        StartCoroutine(SubscribeToHealthEvents());
    }
}
```

### Q3: æŠ€èƒ½å€¼ä¸è‡ªåŠ¨æ¢å¤
**åŸå› ï¼š** autoRegenSkillè®¾ç½®ä¸ºfalseæˆ–skillRegenRateä¸º0

**è§£å†³æ–¹æ¡ˆï¼š**
```csharp
// åœ¨Inspectorä¸­æ£€æŸ¥è®¾ç½®
// æˆ–åœ¨ä»£ç ä¸­å¼ºåˆ¶è®¾ç½®
private void Start()
{
    var health = PlayerHealthSystem.instance;
    if (health != null)
    {
        // é€šè¿‡åå°„è®¾ç½®ç§æœ‰å­—æ®µï¼Œæˆ–æ·»åŠ å…¬å…±è®¾ç½®æ–¹æ³•
        Debug.Log("è¯·åœ¨Inspectorä¸­ç¡®ä¿Auto Regen Skillå·²å‹¾é€‰ï¼ŒSkill Regen Rateå¤§äº0");
    }
}
```

### Q4: è¡€é‡æ¡åŠ¨ç”»ä¸æµç•…
**åŸå› ï¼š** smoothSpeedè®¾ç½®è¿‡ä½æˆ–å¸§ç‡é—®é¢˜

**è§£å†³æ–¹æ¡ˆï¼š**
```csharp
// åœ¨HealthBarUIè„šæœ¬ä¸­è°ƒæ•´åŠ¨ç”»é€Ÿåº¦
[SerializeField] private float smoothSpeed = 5f; // å¢åŠ æ•°å€¼ä½¿åŠ¨ç”»æ›´å¿«

// æˆ–è€…å…³é—­å¹³æ»‘åŠ¨ç”»
[SerializeField] private bool smoothTransition = false;
```

### Q5: å•ä¾‹æ¨¡å¼å†²çª
**åŸå› ï¼š** åœºæ™¯ä¸­æœ‰å¤šä¸ªPlayerHealthSystemå®ä¾‹

**è§£å†³æ–¹æ¡ˆï¼š**
```csharp
// åœ¨PlayerHealthSystemçš„Awakeæ–¹æ³•ä¸­æ·»åŠ æ›´è¯¦ç»†çš„æ£€æŸ¥
private void Awake()
{
    if (instance == null)
    {
        instance = this;
        DontDestroyOnLoad(gameObject); // å¯é€‰ï¼šè·¨åœºæ™¯ä¿æŒ
    }
    else if (instance != this)
    {
        Debug.LogWarning($"æ£€æµ‹åˆ°é‡å¤çš„PlayerHealthSystemå®ä¾‹ï¼é”€æ¯ {gameObject.name}");
        Destroy(gameObject);
        return;
    }
}
```

### Q6: TextMeshProç›¸å…³é”™è¯¯
**åŸå› ï¼š** é¡¹ç›®ä¸­æœªå¯¼å…¥TextMeshProåŒ…

**è§£å†³æ–¹æ¡ˆï¼š**
```
1. åœ¨Unityä¸­æ‰“å¼€ Window â†’ TextMeshPro â†’ Import TMP Essential Resources
2. æˆ–è€…å°†HealthBarUIè„šæœ¬ä¸­çš„TextMeshProUGUIæ”¹ä¸ºTextç»„ä»¶
```

---

## ğŸ“ å®Œæ•´ä»£ç ç¤ºä¾‹

### ç®€å•çš„æ•ŒäººAIç¤ºä¾‹
```csharp
using UnityEngine;

public class SimpleEnemy : MonoBehaviour
{
    [Header("æ”»å‡»è®¾ç½®")]
    [SerializeField] private float attackDamage = 15f;
    [SerializeField] private float attackRange = 2f;
    [SerializeField] private float attackCooldown = 2f;
    
    private float lastAttackTime;
    private Transform player;
    
    private void Start()
    {
        player = PlayerController.instance.transform;
    }
    
    private void Update()
    {
        // æ£€æŸ¥ç©å®¶è·ç¦»
        float distanceToPlayer = Vector3.Distance(transform.position, player.position);
        
        if (distanceToPlayer <= attackRange && Time.time >= lastAttackTime + attackCooldown)
        {
            AttackPlayer();
            lastAttackTime = Time.time;
        }
    }
    
    private void AttackPlayer()
    {
        if (PlayerHealthSystem.instance != null)
        {
            float actualDamage = PlayerHealthSystem.instance.TakeDamage(attackDamage);
            Debug.Log($"æ•Œäººæ”»å‡»é€ æˆ {actualDamage} ç‚¹ä¼¤å®³ï¼");
            
            // æ˜¾ç¤ºä¼¤å®³æ•ˆæœ
            if (UIManager.instance != null)
            {
                UIManager.instance.ShowNotification($"-{actualDamage:F0}", 1.5f);
            }
        }
    }
    
    private void OnDrawGizmosSelected()
    {
        // åœ¨Sceneè§†å›¾ä¸­æ˜¾ç¤ºæ”»å‡»èŒƒå›´
        Gizmos.color = Color.red;
        Gizmos.DrawWireSphere(transform.position, attackRange);
    }
}
```

### ç‰©å“æ‹¾å–ç³»ç»Ÿç¤ºä¾‹
```csharp
using UnityEngine;

public class PickupItem : MonoBehaviour
{
    [Header("ç‰©å“è®¾ç½®")]
    [SerializeField] private ItemType itemType;
    [SerializeField] private float value = 25f;
    [SerializeField] private string itemName = "æ²»ç–—è¯æ°´";
    
    public enum ItemType
    {
        HealthPotion,
        ManaPotion,
        HealthUpgrade,
        ManaUpgrade
    }
    
    private void OnTriggerEnter(Collider other)
    {
        if (other.CompareTag("Player"))
        {
            UseItem();
        }
    }
    
    private void UseItem()
    {
        var health = PlayerHealthSystem.instance;
        if (health == null) return;
        
        switch (itemType)
        {
            case ItemType.HealthPotion:
                float healAmount = health.AddHealth(value);
                ShowPickupMessage($"{itemName} +{healAmount:F0} è¡€é‡");
                break;
                
            case ItemType.ManaPotion:
                float manaAmount = health.AddSkillPoints(value);
                ShowPickupMessage($"{itemName} +{manaAmount:F0} æŠ€èƒ½å€¼");
                break;
                
            case ItemType.HealthUpgrade:
                health.SetMaxHealth(health.MaxHealth + value, true);
                ShowPickupMessage($"{itemName} æœ€å¤§è¡€é‡ +{value:F0}");
                break;
                
            case ItemType.ManaUpgrade:
                health.SetMaxSkillPoints(health.MaxSkillPoints + value, true);
                ShowPickupMessage($"{itemName} æœ€å¤§æŠ€èƒ½å€¼ +{value:F0}");
                break;
        }
        
        // æ’­æ”¾æ‹¾å–éŸ³æ•ˆ
        // AudioSource.PlayClipAtPoint(pickupSound, transform.position);
        
        // æ’­æ”¾æ‹¾å–ç‰¹æ•ˆ
        // Instantiate(pickupEffect, transform.position, Quaternion.identity);
        
        // é”€æ¯ç‰©å“
        Destroy(gameObject);
    }
    
    private void ShowPickupMessage(string message)
    {
        Debug.Log(message);
        
        if (UIManager.instance != null)
        {
            UIManager.instance.ShowNotification(message, 2f);
        }
    }
}
```

---

## ğŸ¯ æ€»ç»“

è¿™ä¸ªç©å®¶å¥åº·ç³»ç»Ÿæä¾›äº†ï¼š

1. **å®Œæ•´çš„è¡€é‡å’ŒæŠ€èƒ½å€¼ç®¡ç†**
2. **äº‹ä»¶é©±åŠ¨çš„UIæ›´æ–°ç³»ç»Ÿ**
3. **å¹³æ»‘çš„åŠ¨ç”»æ•ˆæœ**
4. **æ™ºèƒ½çš„é¢œè‰²å˜åŒ–æç¤º**
5. **ä¸°å¯Œçš„APIæ¥å£**
6. **è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹**
7. **æ‰©å±•æ€§å¼ºçš„æ¶æ„**

æ‚¨å¯ä»¥æ ¹æ®æ¸¸æˆéœ€æ±‚è¿›è¡Œå„ç§è‡ªå®šä¹‰ï¼Œç³»ç»Ÿå·²ç»ä¸ºå¸¸è§çš„æ¸¸æˆåŠŸèƒ½åšå¥½äº†å‡†å¤‡ã€‚

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œè¯·éšæ—¶è¯¢é—®ï¼

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€å¸®åŠ©ï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š
1. ç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½æ­£ç¡®æ·»åŠ åˆ°ç›¸åº”çš„GameObjectä¸Š
2. æ£€æŸ¥UIç»„ä»¶æ˜¯å¦æ­£ç¡®è¿æ¥
3. æŸ¥çœ‹Consoleæ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
4. ä½¿ç”¨æµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸

**å¸¸ç”¨è°ƒè¯•å‘½ä»¤ï¼š**
```csharp
// åœ¨Consoleä¸­æŸ¥çœ‹å½“å‰çŠ¶æ€
Debug.Log(PlayerHealthSystem.instance.GetStatusInfo());

// æµ‹è¯•åŸºæœ¬åŠŸèƒ½
PlayerHealthSystem.instance.TakeDamage(10f);
PlayerHealthSystem.instance.AddHealth(10f);
PlayerHealthSystem.instance.ConsumeSkillPoints(10f);
PlayerHealthSystem.instance.AddSkillPoints(10f);
```